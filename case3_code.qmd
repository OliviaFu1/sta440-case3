---
title: "case3_code"
format: html
editor: visual
---

## Data Processing

```{r}
library(tidyverse)
library(ggplot2)
load("./emsData.RData")
```

## EDA

```{r}
#| warning: false
#| message: false

x |>
  mutate(anstime = DT.ARRIVE - DT.ENROUTE) |>
  ggplot(aes(x = anstime)) +
  facet_wrap(~REF.GRID) +
  geom_histogram(bins = 25) +
  theme_minimal()

```

```{r}
x <- x |>
  mutate(travelTime = DT.ARRIVE - DT.ENROUTE,
    shortestTime = pmin(eTT.UA.NN, eTT.UA.FN, eTT.UA.So, eTT.UA.Ce, na.rm = TRUE))

x |>
  mutate(diff = travelTime - shortestTime) |>
  filter(REF.GRID == "1 North") |>
  ggplot(aes(x = diff)) +
  geom_histogram() +
  theme_minimal()

```

```{r}
ggplot(x,aes(x=REF.GRID, y= dispToClearTime))+geom_histogram(stat= "identity",position="dodge")


# difference in travel time (station to scene vs. scene to hospital)
ggplot(x,aes(x=observedTT,y=toHospitalTT,color=REF.GRID))+geom_point()+geom_smooth()

#difference in travel time ()
ggplot(x,aes(x=atHospitalDur,y=REF.GRID,color=DISPATCH.PRIORITY.NAME))+geom_boxplot()

```



## Model
